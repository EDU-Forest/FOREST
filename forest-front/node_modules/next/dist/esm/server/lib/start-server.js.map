{"version":3,"sources":["../../../src/server/lib/start-server.ts"],"names":["http","isIPv6","Log","getNodeOptionsWithoutInspect","normalizeRepeatedSlashes","startServer","dir","prevDir","port","isDev","hostname","useWorkers","allowRetry","keepAliveTimeout","onStdout","onStderr","process","sockets","Set","worker","handlersReady","handlersError","isNodeDebugging","execArgv","some","localArg","startsWith","env","NODE_OPTIONS","match","handlersPromise","Promise","resolve","reject","requestHandler","_req","_res","Error","upgradeHandler","_socket","_head","server","createServer","req","res","undefined","add","on","delete","err","statusCode","end","error","url","console","socket","head","destroy","portRetryCount","code","warn","listen","exit","targetHost","addr","address","host","normalizedHostname","appUrl","ready","httpProxy","require","renderServerPath","jestWorkerPath","replace","Worker","routerWorker","numWorkers","maxRetries","forkOptions","FORCE_COLOR","trim","exposedMethods","didInitialize","_worker","_workerPool","_workers","_child","signal","workerStdout","getStdout","workerStderr","getStderr","data","stdout","write","stderr","routerPort","initialize","dev","workerType","getProxyServer","pathname","targetUrl","proxyServer","createProxy","target","changeOrigin","ignorePath","xfwd","ws","followRedirects","urlParts","split","urlNoQuery","cleanUrl","setHeader","web","default","next","app","httpServer","customServer","getRequestHandler","getUpgradeHandler","prepare","teardown","close","forEach"],"mappings":"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"}
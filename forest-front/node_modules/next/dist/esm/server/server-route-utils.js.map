{"version":3,"sources":["../../src/server/server-route-utils.ts"],"names":["getRedirectStatus","modifyRouteRegex","getPathMatch","compileNonPath","prepareDestination","getRequestMeta","stringify","stringifyQs","format","formatUrl","normalizeRepeatedSlashes","getCustomRoute","params","rule","type","restrictedRedirectPaths","match","source","strict","removeUnnamedParams","regexModifier","internal","regex","undefined","name","fn","_req","_res","_params","_parsedUrl","finished","createHeaderRoute","headerRoute","matchesBasePath","matchesLocale","matchesLocaleAPIRoutes","matchesTrailingSlash","has","missing","res","hasParams","Object","keys","length","header","headers","key","value","toLowerCase","appendHeader","setHeader","stringifyQuery","req","query","initialQuery","initialQueryValues","values","encodeURIComponent","some","initialQueryVal","Array","isArray","includes","createRedirectRoute","redirectRoute","statusCode","parsedUrl","parsedDestination","appendParamsToQuery","destination","search","updatedDestination","startsWith","redirect","body","send"],"mappings":"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"}
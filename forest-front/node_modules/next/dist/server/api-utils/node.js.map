{"version":3,"sources":["../../../src/server/api-utils/node.ts"],"names":["tryGetPreviewData","parseBody","apiResolver","req","res","options","cookies","checkIsOnDemandRevalidate","isOnDemandRevalidate","SYMBOL_PREVIEW_DATA","headers","HeadersAdapter","from","RequestCookies","previewModeId","get","COOKIE_NAME_PRERENDER_BYPASS","value","tokenPreviewData","COOKIE_NAME_PRERENDER_DATA","clearPreviewData","encryptedPreviewData","jsonwebtoken","require","verify","previewModeSigningKey","decryptWithSecret","decryptedPreviewData","Buffer","previewModeEncryptionKey","data","JSON","parse","Object","defineProperty","enumerable","parseJson","str","length","e","ApiError","limit","contentType","type","parameters","encoding","charset","buffer","getRawBody","isError","body","toString","qs","decode","getMaxContentLength","responseLimit","bytes","RESPONSE_LIMIT_DEFAULT","sendData","undefined","end","statusCode","removeHeader","process","env","NODE_ENV","console","warn","url","getHeader","Stream","setHeader","pipe","isJSONLike","includes","stringifiedBody","stringify","etag","generateETag","sendEtagResponse","isBuffer","byteLength","sendJson","jsonBody","send","isNotValidData","setPreviewData","Error","encryptWithSecret","payload","sign","algorithm","maxAge","expiresIn","serialize","previous","Array","isArray","httpOnly","sameSite","secure","path","revalidate","urlPath","opts","context","startsWith","revalidateHeaders","PRERENDER_REVALIDATE_HEADER","unstable_onlyGenerated","PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER","allowedRevalidateHeaderKeys","trustHostHeader","key","keys","fetch","host","method","cacheHeader","toUpperCase","status","mocked","createRequestResponseMocks","hasStreamed","err","message","query","resolverModule","apiContext","propagateError","dev","page","apiReq","apiRes","config","getTracer","bodyParser","api","externalResolver","setLazyProp","getCookieParser","previewData","sizeLimit","contentLength","maxContentLength","writeData","write","endResponse","args","apply","format","sendStatusCode","json","redirect","statusOrUrl","assign","resolver","interopDefault","wasPiped","once","getRootSpanAttributes","set","apiRouteResult","trace","NodeSpan","runHandler","spanName","Response","isResSent","sendError","error"],"mappings":"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"}
{"version":3,"sources":["../../../src/server/api-utils/index.ts"],"names":["getCookieParser","sendStatusCode","redirect","checkIsOnDemandRevalidate","clearPreviewData","sendError","setLazyProp","headers","parseCookie","cookie","parse","parseCookieFn","require","Array","isArray","join","res","statusCode","statusOrUrl","url","Error","writeHead","Location","write","end","PRERENDER_REVALIDATE_HEADER","PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER","req","previewProps","HeadersAdapter","from","previewModeId","get","isOnDemandRevalidate","revalidateOnlyGenerated","has","COOKIE_NAME_PRERENDER_BYPASS","COOKIE_NAME_PRERENDER_DATA","RESPONSE_LIMIT_DEFAULT","SYMBOL_PREVIEW_DATA","Symbol","SYMBOL_CLEARED_COOKIES","options","serialize","previous","getHeader","setHeader","expires","Date","httpOnly","sameSite","process","env","NODE_ENV","secure","path","undefined","Object","defineProperty","value","enumerable","ApiError","constructor","message","statusMessage","prop","getter","opts","configurable","optsReset","writable","set"],"mappings":"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"}
{"version":3,"sources":["../../../../src/server/lib/incremental-cache/index.ts"],"names":["toRoute","pathname","replace","CacheHandler","constructor","_ctx","get","_key","_fetchCache","set","_data","IncrementalCache","fs","dev","appDir","flushToDisk","fetchCache","minimalMode","serverDistDir","requestHeaders","maxMemoryCacheSize","getPrerenderManifest","fetchCacheKeyPrefix","CurCacheHandler","FileSystemCache","FetchCache","process","env","__NEXT_TEST_MAX_ISR_CACHE","parseInt","prerenderManifest","cacheHandler","_appDir","_requestHeaders","calculateRevalidate","fromTime","Date","getTime","initialRevalidateSeconds","routes","revalidateAfter","_getPathname","normalizePagePath","fetchCacheKey","url","init","MAIN_KEY_PREFIX","cacheKey","bodyChunks","body","getReader","readableBody","reader","arrayBuffer","Uint8Array","processValue","done","value","push","encode","curBuffer","encodeText","prevBuffer","byteLength","err","console","error","read","then","_ogBody","keys","formData","key","Set","values","getAll","Promise","all","map","val","text","join","blob","Blob","type","cacheString","JSON","stringify","method","headers","mode","redirect","credentials","referrer","referrerPolicy","integrity","cache","NEXT_RUNTIME","bufferToHex","buffer","Array","prototype","call","b","toString","padStart","crypto","subtle","digest","require","createHash","update","revalidate","cacheData","entry","kind","age","Math","round","now","lastModified","isStale","data","curRevalidate","undefined","notFoundRoutes","includes","revalidateSeconds","length","Error","dataRoute","path","posix","srcRoute","warn"],"mappings":"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"}